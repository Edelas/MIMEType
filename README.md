Mime types медленно работакет
FNAME.LastIndexOf(".") вызывается два раза вместо одного — ну да фиг с ним, компилятор сам может сообразить это запомнить
а вот это: Extension.IndexOf(
требует линейного времени
то есть растёт пропорционально количеству известных расширений (O(n))
ой.
O ( n )
И таких поисков выходит Q штук
То есть всё вместе O ( Q × N )
И ещё можно запоминать длину самого длинного расширения и при поиске точки в строке изучать не всю строку, а только её хвост
тоже ускорит
Но главное, что надо расширения класть в сортированный список.
Это займёт N × log N времени. (N элементов, log N на поиск места каждому, вставка в список происходит за три операции, то есть мгновенно, за константное время)
Потом поиск в этом списке займёт log N времени для каждого из Q файлов. Итоговая сложность алгоритма 

O ( max (Q, N) × log N )
вместо O ( Q × N )

Хм. То есть если log N больше Q, то сортировать не выгодно: будет O(N × log N) вместо O(N × Q).
В условиях задачи N и Q в одинаковых пределах (до 10к), так что сортировать должно быть выгодно
И кстати, toLower лучше только к расширению применят
ь
Вообще, для такого придумали map
Надо сделать Map, который отображает extension → MimeType
Вставка и поиск в Map реализованы в стандартной библиотеке. Идея та же: ключи (в данном случае расширения) хранятся, как будто это сортированный список. Поиск и вставка — за логарифмическое время
